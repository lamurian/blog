---
author: Aly Lamuri
title: >
  Deep Learning and Connectome
output:
  revealjs::revealjs_presentation:
    self_contained: false
    theme: solarized
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Depression:</p>
<blockquote>
<ul>
<li>Numerically? Stupendous</li>
<li>Anhedonia &amp; anergy</li>
<li>An affective disorder <strong>yet</strong> a constellation of <em>numerous</em> symptoms</li>
<li>Severe economic burden</li>
<li>Irony: treatment failure in roughly half of patients</li>
<li>Finding a biomarker is difficult!</li>
<li>But, how if we look at depression as a result of brain regional interaction?</li>
</ul>
</blockquote>
<div id="brain-connectivity-and-depression" class="section level2">
<h2>Brain Connectivity and Depression</h2>
<ul>
<li>Higher ALFF in hippocampus and amygdala</li>
<li>Uncoupling of cerebellum and caudate nucleus</li>
<li>Connectivity changes after therapeutic session</li>
<li><em>Emerging concept:</em> Connectivity changes as outlined by the graph theory</li>
<li><strong>Current focus:</strong> Implementing deep learning to comprehend brain network</li>
</ul>
</div>
<div id="proposed-model" class="section level2">
<h2>Proposed Model</h2>
<ul>
<li>Uses Graph Convolutional Network</li>
<li>Group: Healthy, mild, moderate, severe</li>
<li>Construct a sparse block diagonal matrix</li>
<li>Embed vertex influence metrics as nodal feature</li>
<li><strong>Output:</strong> A multinomial node-classification model</li>
</ul>
</div>
</div>
<div id="methods" class="section level1">
<h1>Methods</h1>
<ul>
<li>Cross-sectional observational-analytic study</li>
<li>Data from the UK Biobank</li>
<li>Depression category based on the UKB classification</li>
<li>Build adjacency matrix from upper triangle rs-fMRI</li>
<li>Apply proportional threshold</li>
</ul>
<div id="graph-convolutional-network" class="section level2">
<h2>Graph Convolutional Network</h2>
<p>Inputs: Adjacency matrix, nodal feature, nodal label</p>
<p><span class="math display">\[H^{(l+1)} = \sigma (\hat{D}^{- \frac{1}{2}} \cdot \hat{A} \cdot \hat{D}^{- \frac{1}{2}} \cdot H^{(l)} \cdot W^{(l)} + b)\]</span></p>
</div>
<div id="data-preparation" class="section level2">
<h2>Data Preparation</h2>
<ul>
<li>Separate subjects into groups</li>
<li>Reconstruct adjacency matrix</li>
<li>Proportional thresholding (80%) and compute metrics</li>
<li>Concatenate matrices</li>
</ul>
</div>
<div id="statistical-analysis" class="section level2">
<h2>Statistical Analysis</h2>
<ul>
<li>Normality: Anderson-Darling test</li>
<li>ANOVA or Kruskal-Wallis</li>
<li>Alpha: 0.05</li>
<li>Post-Hoc: Tukey’s HSD or Dunn’s Test with Benjamini-Horschberg</li>
<li>Metrics differences across ROIs</li>
</ul>
</div>
<div id="experimental-design" class="section level2">
<h2>Experimental Design</h2>
<ul>
<li>Visualize higher-dimension: T-SNE (hierarchical clustering)</li>
<li>Model using <code>stellargraph</code> in <code>python3.0</code></li>
<li>Back end: <code>tensorflow</code> through <code>keras</code> implementation</li>
<li>Use <code>networkx</code> to parse graph objects</li>
</ul>
</div>
</div>
<div id="model" class="section level1">
<h1>Model</h1>
<pre class="python"><code>from tensorflow.keras import Model
from stellargraph import Ensemble
from stellargraph.layer import GCN, GraphConvolution</code></pre>
<div id="neural-network-layer" class="section level2">
<h2>Neural network layer</h2>
<pre class="python"><code>gcn_layer = GCN(
        [64, 64, train_target.shape[1]],
        generator=generator,
        activations=[&#39;relu&#39;, &#39;relu&#39;, &#39;softmax&#39;],
        dropout=0.5)</code></pre>
</div>
<div id="create-input-and-output-layers" class="section level2">
<h2>Create input and output layers</h2>
<pre class="python"><code>g_input, g_output = gcn_layer.node_model()
model = Model(inputs=g_input, outputs=g_output)</code></pre>
</div>
<div id="use-ensemble-and-compile-the-model" class="section level2">
<h2>Use ensemble and compile the model</h2>
<pre class="python"><code>model = Ensemble(model, n_estimators=5)
model.compile(optimizer=&#39;adam&#39;, loss=&#39;categorical_crossentropy&#39;,
        metrics=[&#39;accuracy&#39;])</code></pre>
</div>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<p><img src="/talk/2006-01_IMERI/index_files/figure-html/plot.tsne-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="deep-learning-accuracy" class="section level2">
<h2>Deep Learning Accuracy</h2>
<pre><code>## Warning in grid.Call.graphics(C_points, x$x, x$y, x$pch, x$size): semi-
## transparency is not supported on this device: reported only once per page</code></pre>
<p><img src="/talk/2006-01_IMERI/index_files/figure-html/plot.acc-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="classification-roc" class="section level2">
<h2>Classification ROC</h2>
<p><img src="/talk/2006-01_IMERI/index_files/figure-html/plot.roc-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
<ul>
<li>High variance in brain network</li>
<li>Dimensionality reduction technique could not sufficiently cluster data</li>
<li>Geometric deep learning: algorithm on graph and manifold?</li>
</ul>
</div>
